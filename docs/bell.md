---
title: Bell numbers
documentation_of: //tools/bell.hpp
---

It calculates the Bell numbers $B(n, k) = \sum_{i = 0}^k S(n, i)$ where $S(n, i)$ is the Stirling number of the second kind.

### List of $B(n, k)$

|$n \backslash k$|$0$|$1$|       $2$|            $3$|             $4$|              $5$|              $6$|                  $7$|                  $8$|                  $9$|                 $10$|                  $11$|               $12$|                  $13$|                 $14$|                 $15$|
|             $0$|$1$|$1$|       $1$|            $1$|             $1$|              $1$|              $1$|                  $1$|                  $1$|                  $1$|                  $1$|                   $1$|                $1$|                   $1$|                  $1$|                  $1$|
|             $1$|$0$|$1$|       $1$|            $1$|             $1$|              $1$|              $1$|                  $1$|                  $1$|                  $1$|                  $1$|                   $1$|                $1$|                   $1$|                  $1$|                  $1$|
|             $2$|$0$|$1$|       $2$|            $2$|             $2$|              $2$|              $2$|                  $2$|                  $2$|                  $2$|                  $2$|                   $2$|                $2$|                   $2$|                  $2$|                  $2$|
|             $3$|$0$|$1$|       $4$|            $5$|             $5$|              $5$|              $5$|                  $5$|                  $5$|                  $5$|                  $5$|                   $5$|                $5$|                   $5$|                  $5$|                  $5$|
|             $4$|$0$|$1$|       $8$|           $14$|            $15$|             $15$|             $15$|                 $15$|                 $15$|                 $15$|                 $15$|                  $15$|               $15$|                  $15$|                 $15$|                 $15$|
|             $5$|$0$|$1$|      $16$|           $41$|            $51$|             $52$|             $52$|                 $52$|                 $52$|                 $52$|                 $52$|                  $52$|               $52$|                  $52$|                 $52$|                 $52$|
|             $6$|$0$|$1$|      $32$|          $122$|           $187$|            $202$|            $203$|                $203$|                $203$|                $203$|                $203$|                 $203$|              $203$|                 $203$|                $203$|                $203$|
|             $7$|$0$|$1$|      $64$|          $365$|           $715$|            $855$|            $876$|                $877$|                $877$|                $877$|                $877$|                 $877$|              $877$|                 $877$|                $877$|                $877$|
|             $8$|$0$|$1$|     $128$|      $1{,}094$|       $2{,}795$|        $3{,}845$|        $4{,}111$|            $4{,}139$|            $4{,}140$|            $4{,}140$|            $4{,}140$|            $4{,}140$|           $4{,}140$|             $4{,}140$|            $4{,}140$|            $4{,}140$|
|             $9$|$0$|$1$|     $256$|      $3{,}281$|      $11{,}051$|       $18{,}002$|       $20{,}648$|           $21{,}110$|           $21{,}146$|           $21{,}147$|           $21{,}147$|           $21{,}147$|          $21{,}147$|            $21{,}147$|           $21{,}147$|           $21{,}147$|
|            $10$|$0$|$1$|     $512$|      $9{,}842$|      $43{,}947$|       $86{,}472$|      $109{,}299$|          $115{,}179$|          $115{,}929$|          $115{,}974$|          $115{,}975$|          $115{,}975$|          $115{,}975$|          $115{,}975$|          $115{,}975$|          $115{,}975$|
|            $11$|$0$|$1$| $1{,}024$|     $29{,}525$|     $175{,}275$|      $422{,}005$|      $601{,}492$|          $665{,}479$|          $677{,}359$|          $678{,}514$|          $678{,}569$|          $678{,}570$|          $678{,}570$|          $678{,}570$|          $678{,}570$|          $678{,}570$|
|            $12$|$0$|$1$| $2{,}048$|     $88{,}574$|     $700{,}075$|  $2{,}079{,}475$|  $3{,}403{,}127$|      $4{,}030{,}523$|      $4{,}189{,}550$|      $4{,}211{,}825$|      $4{,}213{,}530$|      $4{,}213{,}596$|      $4{,}213{,}597$|      $4{,}213{,}597$|      $4{,}213{,}597$|      $4{,}213{,}597$|
|            $13$|$0$|$1$| $4{,}096$|    $265{,}721$| $2{,}798{,}251$| $10{,}306{,}752$| $19{,}628{,}064$|     $25{,}343{,}488$|     $27{,}243{,}100$|     $27{,}602{,}602$|     $27{,}641{,}927$|     $27{,}644{,}358$|     $27{,}644{,}436$|     $27{,}644{,}437$|     $27{,}644{,}437$|     $27{,}644{,}437$|
|            $14$|$0$|$1$| $8{,}192$|    $797{,}162$|$11{,}188{,}907$| $51{,}263{,}942$|$114{,}700{,}315$|    $164{,}029{,}595$|    $184{,}941{,}915$|    $190{,}077{,}045$|    $190{,}829{,}797$|    $190{,}895{,}863$|    $190{,}899{,}230$|    $190{,}899{,}321$|    $190{,}899{,}322$|    $190{,}899{,}322$|
|            $15$|$0$|$1$|$16{,}384$|$2{,}391{,}485$|$44{,}747{,}435$|$255{,}514{,}355$|$676{,}207{,}628$|$1{,}084{,}948{,}961$|$1{,}301{,}576{,}801$|$1{,}368{,}705{,}291$|$1{,}381{,}367{,}941$|$1{,}382{,}847{,}419$|$1{,}382{,}953{,}889$|$1{,}382{,}958{,}439$|$1{,}382{,}958{,}544$|$1{,}382{,}958{,}545$|

## bell::fixed_n
```cpp
template <typename M>
tools::fps<M> bell::fixed_n(int N, int K);
```

It returns $B(N, k) \pmod{P}$ for all $k$ such that $0 \leq k \leq K$, where $P$ is `M::mod()`.

### Constraints
- `<M>` is `atcoder::static_modint` or `atcoder::dynamic_modint`.
- $P$ is a prime.
- $0 \leq \min(N, K) < P$

### Time Complexity
- $O(\min(N, K) \log(\min(N, K)) + K)$

### License
- CC0

### Author
- anqooqie

## bell::diagonal
```cpp
template <typename M>
tools::fps<M> bell::diagonal(int N);
```

It returns $B(n, n) \pmod{P}$ for all $n$ such that $0 \leq n \leq N$, where $P$ is `M::mod()`.

### Constraints
- `<M>` is `atcoder::static_modint` or `atcoder::dynamic_modint`.
- $P$ is a prime.
- $0 \leq N < P$

### Time Complexity
- $O(N \log N)$

### License
- CC0

### Author
- anqooqie

## bell::all
```cpp
template <typename M>
std::vector<std::vector<M>> bell::all(int N, int K);
```

It returns $B(n, k) \pmod{M}$ for all $n$ such that $0 \leq n \leq N$ and all $k$ such that $0 \leq k \leq K$, where $M$ is `M::mod()`.

### Constraints
- `<M>` is `atcoder::static_modint` or `atcoder::dynamic_modint`.
- $N \geq 0$
- $K \geq 0$

### Time Complexity
- $O(NK)$

### License
- CC0

### Author
- anqooqie
