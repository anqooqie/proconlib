---
title: Signed Stirling numbers of the first kind
documentation_of: //tools/stirling_1st.hpp
---

It calculates the signed Stirling numbers of the first kind $s(n, k) = [x^k] (x)_n$.

### List of $s(n, k)$

|$n \backslash k$|$0$|                   $1$|                     $2$|                    $3$|                     $4$|                    $5$|                    $6$|                   $7$|                   $8$|              $9$|              $10$|          $11$|        $12$|     $13$|  $14$|$15$|
|             $0$|$1$|                   $0$|                     $0$|                    $0$|                     $0$|                    $0$|                    $0$|                   $0$|                   $0$|              $0$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|             $1$|$0$|                   $1$|                     $0$|                    $0$|                     $0$|                    $0$|                    $0$|                   $0$|                   $0$|              $0$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|             $2$|$0$|                  $-1$|                     $1$|                    $0$|                     $0$|                    $0$|                    $0$|                   $0$|                   $0$|              $0$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|             $3$|$0$|                   $2$|                    $-3$|                    $1$|                     $0$|                    $0$|                    $0$|                   $0$|                   $0$|              $0$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|             $4$|$0$|                  $-6$|                    $11$|                   $-6$|                     $1$|                    $0$|                    $0$|                   $0$|                   $0$|              $0$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|             $5$|$0$|                  $24$|                   $-50$|                   $35$|                   $-10$|                    $1$|                    $0$|                   $0$|                   $0$|              $0$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|             $6$|$0$|                $-120$|                   $274$|                 $-225$|                    $85$|                  $-15$|                    $1$|                   $0$|                   $0$|              $0$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|             $7$|$0$|                 $720$|              $-1{,}764$|              $1{,}624$|                  $-735$|                  $175$|                  $-21$|                   $1$|                   $0$|              $0$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|             $8$|$0$|            $-5{,}040$|              $13{,}068$|            $-13{,}132$|               $6{,}769$|             $-1{,}960$|                  $322$|                 $-28$|                   $1$|              $0$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|             $9$|$0$|            $40{,}320$|            $-109{,}584$|            $118{,}124$|             $-67{,}284$|             $22{,}449$|             $-4{,}536$|                 $546$|                 $-36$|              $1$|               $0$|           $0$|         $0$|      $0$|   $0$| $0$|
|            $10$|$0$|          $-362{,}880$|         $1{,}026{,}576$|       $-1{,}172{,}700$|             $723{,}680$|           $-269{,}325$|             $63{,}273$|            $-9{,}450$|                 $870$|            $-45$|               $1$|           $0$|         $0$|      $0$|   $0$| $0$|
|            $11$|$0$|       $3{,}628{,}800$|       $-10{,}628{,}640$|       $12{,}753{,}576$|        $-8{,}409{,}500$|        $3{,}416{,}930$|           $-902{,}055$|           $157{,}773$|           $-18{,}150$|        $1{,}320$|            $-55$|            $1$|         $0$|      $0$|   $0$| $0$|
|            $12$|$0$|     $-39{,}916{,}800$|       $120{,}543{,}840$|     $-150{,}917{,}976$|       $105{,}258{,}076$|      $-45{,}995{,}730$|       $13{,}339{,}535$|      $-2{,}637{,}558$|           $357{,}423$|      $-32{,}670$|        $1{,}925$|          $-66$|         $1$|      $0$|   $0$| $0$|
|            $13$|$0$|     $479{,}001{,}600$|  $-1{,}486{,}442{,}880$|  $1{,}931{,}559{,}552$|  $-1{,}414{,}014{,}888$|      $657{,}206{,}836$|     $-206{,}070{,}150$|      $44{,}990{,}231$|      $-6{,}926{,}634$|      $749{,}463$|      $-55{,}770$|      $2{,}717$|       $-78$|      $1$|   $0$| $0$|
|            $14$|$0$|$-6{,}227{,}020{,}800$|  $19{,}802{,}759{,}040$|$-26{,}596{,}717{,}056$|  $20{,}313{,}753{,}096$| $-9{,}957{,}703{,}756$|  $3{,}336{,}118{,}786$|    $-790{,}943{,}153$|     $135{,}036{,}473$|$-16{,}669{,}653$|  $1{,}474{,}473$|    $-91{,}091$|   $3{,}731$|    $-91$|   $1$| $0$|
|            $15$|$0$|$87{,}178{,}291{,}200$|$-283{,}465{,}647{,}360$|$392{,}156{,}797{,}824$|$-310{,}989{,}260{,}400$|$159{,}721{,}605{,}680$|$-56{,}663{,}366{,}760$|$14{,}409{,}322{,}928$|$-2{,}681{,}453{,}775$|$368{,}411{,}615$|$-37{,}312{,}275$|$2{,}749{,}747$|$-143{,}325$|$5{,}005$|$-105$| $1$|

### License
- CC0

### Author
- anqooqie

## fixed_n
```cpp
template <typename M>
tools::virtual_vector<(anonymous type)> stirling_1st::fixed_n(int N, int K);
```

It returns $s(N, k) \pmod{P}$ for all $k$ such that $0 \leq k \leq K$, where $P$ is `M::mod()`.

### Constraints
- `<M>` is `atcoder::static_modint` or `atcoder::dynamic_modint`.
- $P$ is a prime.
- $0 \leq N < P$

### Time Complexity
- $O(N \log N)$

## fixed_k
```cpp
template <typename M>
tools::virtual_vector<(anonymous type)> stirling_1st::fixed_k(int N, int K);
```

It returns $s(n, K) \pmod{P}$ for all $n$ such that $0 \leq n \leq N$, where $P$ is `M::mod()`.

### Constraints
- `<M>` is `atcoder::static_modint` or `atcoder::dynamic_modint`.
- $P$ is a prime.
- $N \geq 0$
- $0 \leq K < P$
- $N - K + 1 < P$

### Time Complexity
- $O((N - K) \log (N - K) + K)$

## diagonal
```cpp
template <typename M>
tools::virtual_vector<(anonymous type)> stirling_1st::diagonal(int N);
```

It returns $s(n, n) \pmod{M}$ for all $n$ such that $0 \leq n \leq N$, where $M$ is `M::mod()`.
Note that $s(n, n) = 1$.

### Constraints
- `<M>` is `atcoder::static_modint` or `atcoder::dynamic_modint`.
- $N \geq 0$

### Time Complexity
- $O(1)$

## all
```cpp
template <typename M>
std::vector<std::vector<M>> stirling_1st::all(int N, int K);
```

It returns $s(n, k) \pmod{M}$ for all $n$ such that $0 \leq n \leq N$ and all $k$ such that $0 \leq k \leq K$, where $M$ is `M::mod()`.

### Constraints
- `<M>` is `atcoder::static_modint` or `atcoder::dynamic_modint`.
- $N \geq 0$
- $K \geq 0$

### Time Complexity
- $O(NK)$
